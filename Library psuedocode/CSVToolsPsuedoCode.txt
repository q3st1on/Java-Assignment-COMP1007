package Library
import java.io.*
import java.util.*



    filePath (String)
    csvHeader <- (String) ["title","familyNameOne",  "firstNameOne",  "nationalityOne",  "birthYearOne","familyNameTwo",  "firstNameTwo",  "nationalityTwo",  "birthYearTwo","familyNameThree","firstNameThree","nationalityThree","birthYearThree","year","isbn","ebook","edition"]


METHOD: verifyHeader
IMPORT: testHeader (String[])
EXPORT: result
ALGORITHM:    
    result <- false
    IF csvHeader = testHeader THEN
        result <- true
    ENDIF
END verifyHeader

METHOD: csvReader
IMPORT: None
EXPORT: data (String[][])
ALGORITHM:    
    empty <- true
    data <- [[]]
    file <- File(filePath)

    line <- file.readLine()
    WHILE line != null DO
        IF empty THEN
            data[0] <- line.split(",")
            empty <- false
        ELSE
            data.append(line)
        ENDIF

        line <- br.readLine()
    ENDWHILE

    file.close()
END csvReader

METHOD: writeCSVLine
IMPORT: data (String[]), file (FileOutputStream)
EXPORT: None
ALGORITHM:  
    FOR i <- 0 TO data.length - 1 CHANGEBY 1
        file.write(data[i])
        file.write(",")
    ENDFOR

    file.write(data[data.length-1])
    file.write("\n")
END writeCSVLine
w
METHOD: writeCSV
IMPORT: None
EXPORT: None
ALGORITHM:  
    tempFile <- new File(".libraryDataFile.tmp")
    fileStream <- new FileOutputStream(tempFile)
    writeCSVLine(csvHeader, fileStream)
    
    FOR EACH book IN books    
        array[0] <- book.getTitle()
        FOR i <- 0 TO 3 CHANGEBY 1
            IF i < book.getAuthorCount() THEN
                array[1+(i*4)] <- book.getAuthors()[i].getLastName()
                array[2+(i*4)] <- book.getAuthors()[i].getFirstName()
                array[3+(i*4)] <- book.getAuthors()[i].getNationality()
                array[4+(i*4)] <- book.getAuthors()[i].getBirthYear()
            ELSE
                array[1+(i*4)] <- ""
                array[2+(i*4)] <- ""
                array[3+(i*4)] <- ""
                array[4+(i*4)] <- ""
            ENDIF
        ENDFOR
        
        array[13] <- book.getYear()
        array[14] <- book.getISBN()
        IF book.isEbook() THEN
            array[15] <- "TRUE"
        ELSE
            array[15] <- "FALSE"
        END IF

        array[16] <- String.valueOf(book.getEdition())
        writeCSVLine(array, fileStream)
    END FOR

    fileStream.flush()
    fileStream.close()

    tempFile.renameTo(outFile)
END writeCSV
    



